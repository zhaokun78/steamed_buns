{
	"bsonType": "object",
	"permission": {
		"create": true,
		"delete": false,
		"read": "doc.user_id == auth.uid",
		"update": false
	},
	"properties": {
		"_id": {
			"description": "存储文档 ID（统一订单 ID），系统自动生成"
		},
		"create_time": {
			"bsonType": "timestamp",
			"description": "订单创建时间/发起退款时间",
			"label": "订单创建时间/发起退款时间",
			"forceDefaultValue": {
				"$env": "now"
			}
		},
		"pick_up_number": {
			"bsonType": "int",
			"description": "取餐号",
			"label": "取餐号"
		},
		"user_id": {
			"bsonType": "string",
			"description": "下单用户ID，uni-id-users表",
			"label": "下单用户ID",
			"forceDefaultValue": {
				"$env": "uid"
			},
			"foreignKey": "uni-id-users._id"
		},
		"status": {
			"bsonType": "int",
			"description": "订单状态，1：待付款，2：已付款，3：已完成，4：退款审核中，5：退款中，6：已退款，-1已取消付款/退款，-2：退款拒绝，-3：退款失败",
			"label": "订单状态",
			"defaultValue": 1,
			"enum": [{
				"text": "待付款",
				"value": 1
			}, {
				"text": "已付款",
				"value": 2
			}, {
				"text": "已完成",
				"value": 3
			}, {
				"text": "退款审核中",
				"value": 4
			}, {
				"text": "退款中",
				"value": 5
			}, {
				"text": "已退款",
				"value": 6
			}, {
				"text": "已取消付款/退款",
				"value": -1
			}, {
				"text": "退款拒绝",
				"value": -2
			}, {
				"text": "退款失败",
				"value": -3
			}],
			"maximum": 6,
			"minimum": -3
		},
		"type": {
			"bsonType": "int",
			"description": "订单类型",
			"label": "订单类型",
			"enum": [{
				"text": "自提",
				"value": 0
			}, {
				"text": "外卖",
				"value": 1
			}]
		},
		"store": {
			"bsonType": "string",
			"description": "自提店铺Id",
			"label": "自提店铺Id",
			"foreignKey": "wfy-shop._id"
		},
		"address": {
			"bsonType": "string",
			"description": "收货地址Id",
			"label": "收货地址Id",
			"foreignKey": "uni-id-address"
		},
		"total_fee": {
			"bsonType": "int",
			"description": "订单总金额，单位：分。",
			"label": "订单总金额（分）"
		},
		"paid_time": {
			"bsonType": "timestamp",
			"description": "订单付款时间",
			"label": "付款时间"
		},
		"pay_type": {
			"bsonType": "string",
			"description": "支付渠道，wxpay | alipay",
			"label": "支付渠道",
			"forceDefaultValue": "wxpay"
		},
		"transaction_id": {
			"bsonType": "string",
			"description": "微信或支付宝交易单号",
			"label": "交易单号"
		},
		"update_time": {
			"bsonType": "timestamp",
			"description": "订单更新时间",
			"label": "订单更新时间"
		},
		"platform": {
			"bsonType": "string",
			"description": "下单平台类型：h5、mp-weixin、mp-alipay、app-plus等",
			"label": "下单平台类型",
			"forceDefaultValue": "mp-weixin"
		},
		"is_refund": {
			"bsonType": "bool",
			"description": "是否是退款订单",
			"label": "是否退款订单"
		},
		"refund_amount": {
			"bsonType": "int",
			"description": "退款金额（非退款订单表示已退款总金额，退款订单表示该笔退款的退款金额），单位：分",
			"label": "退款金额（分）"
		},
		"refund_desc": {
			"bsonType": "string",
			"description": "退款原因",
			"label": "退款原因"
		},
		"refund_time": {
			"bsonType": "timestamp",
			"description": "订单完成退款时间",
			"label": "完成退款时间"
		}
	},
	"required": []
}
